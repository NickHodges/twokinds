---
import LikeButton from './LikeButton.astro';

// eslint-disable-next-line @typescript-eslint/no-unused-vars
interface Props {
  id: number;
  introText: string;
  typeName: string;
  pronoun?: string;
  firstKind: string;
  secondKind: string;
  createdAt: Date;
  isLiked?: boolean;
  totalLikes?: number;
  isAuthenticated?: boolean;
  canEdit?: boolean;
}

const {
  id,
  introText,
  typeName,
  pronoun = 'who',
  firstKind,
  secondKind,
  createdAt,
  isLiked = false,
  totalLikes = 0,
  isAuthenticated = false,
  canEdit = false,
} = Astro.props;
---

<article
  class="bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-shadow overflow-hidden flex flex-col h-full group"
>
  <div class="p-6 flex-grow overflow-hidden">
    <!-- Intro and type in one line -->
    <div class="mb-4">
      <h3 class="text-xl font-semibold text-gray-900 dark:text-white">
        {introText}{' '}
        <span class="text-purple-600 dark:text-purple-400 font-semibold">
          {typeName}
        </span>
      </h3>
    </div>

    <!-- The two kinds in a cohesive block -->
    <div class="space-y-3 text-gray-700 dark:text-gray-300">
      <p class="leading-relaxed">
        <span class="text-blue-600 dark:text-blue-400 font-semibold">Those {pronoun} </span>
        <span class="break-words">{firstKind}</span>
      </p>
      <p class="leading-relaxed">
        <span class="text-gray-500 dark:text-gray-400 font-medium">and </span>
        <span class="text-blue-600 dark:text-blue-400 font-semibold">those {pronoun} </span>
        <span class="break-words">{secondKind}</span>
      </p>
    </div>
  </div>

  <div
    class="px-6 py-3 bg-gray-50 dark:bg-gray-700 border-t border-gray-200 dark:border-gray-600 flex justify-between items-center mt-auto"
  >
    <div class="flex items-center gap-4">
      {
        id && (
          <>
            <a
              href={`/saying/${id}`}
              class="text-xs text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium"
            >
              View as quote →
            </a>
            {canEdit && (
              <>
                <a
                  href={`/edit-saying/${id}`}
                  class="text-xs text-emerald-600 dark:text-emerald-400 hover:text-emerald-800 dark:hover:text-emerald-300 font-medium"
                >
                  Edit saying →
                </a>
                <form method="POST" action="/api/delete-saying" class="inline">
                  <input type="hidden" name="sayingId" value={id} />
                  <button
                    type="submit"
                    class="text-xs text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 font-medium"
                  >
                    Delete
                  </button>
                </form>
              </>
            )}
            <LikeButton
              sayingId={id}
              initialLiked={isLiked}
              totalLikes={totalLikes}
              isAuthenticated={isAuthenticated}
            />
          </>
        )
      }
    </div>
    <time datetime={createdAt.toISOString()} class="text-xs text-gray-500 dark:text-gray-400">
      {
        new Date(createdAt).toLocaleDateString('en-US', {
          year: 'numeric',
          month: 'short',
          day: 'numeric',
        })
      }
    </time>
  </div>
</article>
