---
import { Auth, SignIn, SignOut } from 'auth-astro/components';
import type { Session } from '@auth/core/types';

interface Props {
  session?: Session | null;
}

const { session = Astro.locals.session } = Astro.props;
---

<div class="flex items-center gap-2">
  <Auth>
    {(session: Session | null) => {
      return session ? (
        <div class="flex items-center gap-2">
          {session.user?.image && (
            <img
              src={session.user.image}
              alt={session.user?.name || "User avatar"}
              class="w-8 h-8 rounded-full"
            />
          )}
          <span class="text-gray-700 dark:text-gray-300">{session.user?.name}</span>
          <SignOut class="text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400">
            Sign out
          </SignOut>
        </div>
      ) : (
        <div class="flex items-center gap-2">
          <a href="/auth/signin" class="text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400">
            Sign in
          </a>
        </div>
      );
    }}
  </Auth>
</div>

<style>
  :global(.auth-astro-sign-in-button),
  :global(.auth-astro-sign-out-button) {
    background: none !important;
    border: none !important;
    padding: 0 !important;
    font: inherit !important;
    cursor: pointer !important;
    outline: inherit !important;
    color: inherit !important;
  }
</style>